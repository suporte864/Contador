<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
    <meta name="viewport" content="width=624, height=312, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>Contador de Acidentes</title>

<style>

/* RESET */
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family: Arial, Helvetica, sans-serif;
}

/* Corpo geral */
body{
    background:#f0f0f0;
    display:flex;
    flex-direction:column;
    align-items:center;
    padding:20px;
}

/* Área do painel (624x312) */
.painel{
    position:relative;
    width:624px;
    height:312px;
    overflow:hidden;
    border-radius:10px;
    background:black;
}

/* Vídeo */
.painel video{
    position:absolute;
    top:0;
    left:0;

    width:100%;
    height:100%;

    object-fit:contain; /* NÃO CORTA */
    background:black;
}

/* Camada escura */
.overlay{
    position:absolute;
    width:100%;
    height:100%;
    background:rgba(0,0,0,0.25); /* Leve escurecimento */
}

/* Conteúdo */
.conteudo{
    position:relative;
    z-index:2;
    width:100%;
    height:100%;
    color:#003366;

    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    text-align:center;
}

/* Título */
.titulo{
    font-size:34px;
    font-weight:bold;
}

/* Contador */
.numero{
    font-size:76px;
    font-weight:bold;
    margin:5px 0;
}

/* Infos */
.info{
    font-size:18px;
    margin:2px;
}

/* Controles fora */
.controles{
    margin-top:15px;
    display:flex;
    gap:10px;
    align-items:center;
}

/* Botões */
button{
    padding:8px 16px;
    border:none;
    border-radius:6px;
    background:#003366;
    color:white;
    font-weight:bold;
    cursor:pointer;
}

button:hover{
    background:#002244;
}

/* Input */
input[type="date"]{
    padding:7px;
    border-radius:5px;
    border:1px solid #ccc;
    font-size:14px;
}

</style>
</head>

<body>

<!-- PAINEL -->
<div class="painel">

    <video autoplay muted loop playsinline>
        <source src="video4.mp4" type="video/mp4">
    </video>

    <div class="overlay"></div>

    <div class="conteudo">

        <div class="titulo">Dias sem Acidentes</div>

        <div class="numero" id="dias">0</div>

        <div class="info" id="data"></div>
        <div class="info" id="hora"></div>
        <div class="info" id="recorde"></div>

    </div>

</div>


<!-- CONTROLES -->
<div class="controles">

    <input type="date" id="dataInicio">

    <button onclick="definirData()">
        Definir Início
    </button>

    <button onclick="reiniciar()">
        Reiniciar
    </button>

</div>


<script>

/* Data inicial */
let dataInicial = localStorage.getItem("dataInicial");

if(!dataInicial){
    dataInicial = "2023-12-10";
    localStorage.setItem("dataInicial", dataInicial);
}

document.getElementById("dataInicio").value = dataInicial;


/* Calcular dias */
function calcularDias(){

    const inicio = new Date(dataInicial + "T00:00:00-03:00");

    const agora = new Date();

    const hojeSP = new Date(
        agora.toLocaleString("pt-BR", {
            timeZone: "America/Sao_Paulo"
        })
    );

    inicio.setHours(0,0,0,0);
    hojeSP.setHours(0,0,0,0);

    const diff = hojeSP.getTime() - inicio.getTime();

    const dias = Math.floor(diff / (1000 * 60 * 60 * 24));

    document.getElementById("dias").innerText = dias;

    /* Recorde */
    let recorde = localStorage.getItem("recorde");

    if(!recorde || dias > recorde){
        recorde = dias;
        localStorage.setItem("recorde", recorde);
    }

    document.getElementById("recorde").innerText =
        "Recorde: " + recorde + " dias";
}


/* Data */
function atualizarData(){

    const hoje = new Date().toLocaleDateString("pt-BR",{
        timeZone:"America/Sao_Paulo"
    });

    document.getElementById("data").innerText =
        "Data: " + hoje;
}


/* Hora */
function atualizarHora(){

    const hora = new Date().toLocaleTimeString("pt-BR",{
        timeZone:"America/Sao_Paulo",
        hour12:false
    });

    document.getElementById("hora").innerText =
        "Hora: " + hora;
}


/* Definir data */
function definirData(){

    const nova = document.getElementById("dataInicio").value;

    if(!nova){
        alert("Selecione uma data.");
        return;
    }

    dataInicial = nova;

    localStorage.setItem("dataInicial", dataInicial);

    calcularDias();
}


/* Reiniciar */
function reiniciar(){

    if(confirm("Reiniciar para hoje?")){

        const hoje = new Date().toLocaleDateString("en-CA",{
            timeZone:"America/Sao_Paulo"
        });

        dataInicial = hoje;

        localStorage.setItem("dataInicial", dataInicial);

        document.getElementById("dataInicio").value = dataInicial;

        calcularDias();
    }
}


/* Inicialização */
calcularDias();
atualizarData();
atualizarHora();

setInterval(atualizarHora,1000);
setInterval(calcularDias,60000);

</script>

</body>
</html>


